import{j as e,Y as B,Z as H,_ as Q,$ as A,a0 as E,a1 as W,a2 as ee,a3 as se}from"./ui-TC4ngNOa.js";import{r as d}from"./vendor-DXsvu-ZH.js";import{c as n,X as ae,e as D,f as R,h as z,g as te,i as le,a8 as de,I as re,a9 as ne,aa as ie,ab as ce,ac as oe,ad as me,ae as b,B as v,D as xe,af as he,ag as _,a4 as ue,ah as je,ai as fe,aj as pe,ak as ge,a as w}from"./assessment-DBrPHVcv.js";import{b as Ne}from"./admin-BS9rNyd3.js";import{f as g}from"./format-BYZyOPTB.js";const I=d.forwardRef(({className:a,...t},l)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:l,className:n("w-full caption-bottom text-sm",a),...t})}));I.displayName="Table";const P=d.forwardRef(({className:a,...t},l)=>e.jsx("thead",{ref:l,className:n("[&_tr]:border-b",a),...t}));P.displayName="TableHeader";const L=d.forwardRef(({className:a,...t},l)=>e.jsx("tbody",{ref:l,className:n("[&_tr:last-child]:border-0",a),...t}));L.displayName="TableBody";const be=d.forwardRef(({className:a,...t},l)=>e.jsx("tfoot",{ref:l,className:n("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...t}));be.displayName="TableFooter";const y=d.forwardRef(({className:a,...t},l)=>e.jsx("tr",{ref:l,className:n("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...t}));y.displayName="TableRow";const c=d.forwardRef(({className:a,...t},l)=>e.jsx("th",{ref:l,className:n("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...t}));c.displayName="TableHead";const o=d.forwardRef(({className:a,...t},l)=>e.jsx("td",{ref:l,className:n("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...t}));o.displayName="TableCell";const ve=d.forwardRef(({className:a,...t},l)=>e.jsx("caption",{ref:l,className:n("mt-4 text-sm text-muted-foreground",a),...t}));ve.displayName="TableCaption";const we=W,ye=ee,Ce=se,M=d.forwardRef(({className:a,...t},l)=>e.jsx(B,{ref:l,className:n("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t}));M.displayName=B.displayName;const O=d.forwardRef(({className:a,children:t,...l},N)=>e.jsxs(Ce,{children:[e.jsx(M,{}),e.jsxs(H,{ref:N,className:n("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[t,e.jsxs(Q,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));O.displayName=H.displayName;const F=({className:a,...t})=>e.jsx("div",{className:n("flex flex-col space-y-1.5 text-center sm:text-left",a),...t});F.displayName="DialogHeader";const V=d.forwardRef(({className:a,...t},l)=>e.jsx(A,{ref:l,className:n("text-lg font-semibold leading-none tracking-tight",a),...t}));V.displayName=A.displayName;const U=d.forwardRef(({className:a,...t},l)=>e.jsx(E,{ref:l,className:n("text-sm text-muted-foreground",a),...t}));U.displayName=E.displayName;function ze(){const{submissions:a,isLoading:t,fetchSubmissions:l,exportToCSV:N,deleteSubmission:G}=Ne(),[m,u]=d.useState([]),[x,Y]=d.useState(""),[j,$]=d.useState("all"),[i,X]=d.useState(null),h=d.useMemo(()=>a.filter(s=>{var p,T,k;const r=!x||((p=s.organization_name)==null?void 0:p.toLowerCase().includes(x.toLowerCase()))||((T=s.full_name)==null?void 0:T.toLowerCase().includes(x.toLowerCase()))||((k=s.email)==null?void 0:k.toLowerCase().includes(x.toLowerCase())),f=j==="all"||j==="completed"&&s.completed||j==="incomplete"&&!s.completed;return r&&f}),[a,x,j]),Z=s=>{u(s?h.map(r=>r.id):[])},q=(s,r)=>{u(r?f=>[...f,s]:f=>f.filter(p=>p!==s))},J=()=>{const s=a.filter(r=>m.includes(r.id));N(s)},K=async()=>{if(confirm(`Delete ${m.length} submissions? This cannot be undone.`)){for(const s of m)await G(s);u([])}},C=s=>e.jsx(w,{variant:s?"default":"secondary",children:s?"Completed":"In Progress"}),S=s=>{const r={TECH:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",REG:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",GEN:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"};return e.jsx(w,{variant:"secondary",className:r[s],children:s})};return t?e.jsxs(D,{children:[e.jsx(R,{children:e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/3"})]})}),e.jsx(z,{children:e.jsx("div",{className:"animate-pulse space-y-4",children:[...Array(5)].map((s,r)=>e.jsx("div",{className:"h-16 bg-muted rounded"},r))})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Submissions"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and review assessment submissions"})]})}),e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{children:"All Submissions"}),e.jsxs(le,{children:[h.length," of ",a.length," submissions"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(re,{placeholder:"Search submissions...",value:x,onChange:s=>Y(s.target.value),className:"pl-9 w-64"})]}),e.jsxs(ne,{value:j,onValueChange:$,children:[e.jsxs(ie,{className:"w-40",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),e.jsx(oe,{})]}),e.jsxs(me,{children:[e.jsx(b,{value:"all",children:"All Status"}),e.jsx(b,{value:"completed",children:"Completed"}),e.jsx(b,{value:"incomplete",children:"In Progress"})]})]})]})]}),m.length>0&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-muted rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium",children:[m.length," selected"]}),e.jsxs(v,{size:"sm",variant:"outline",onClick:J,children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Export CSV"]}),e.jsxs(v,{size:"sm",variant:"destructive",onClick:K,children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}),e.jsx(z,{children:e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(I,{children:[e.jsx(P,{children:e.jsxs(y,{children:[e.jsx(c,{className:"w-12",children:e.jsx(_,{checked:m.length===h.length&&h.length>0,onCheckedChange:Z})}),e.jsx(c,{children:"Organization"}),e.jsx(c,{children:"Contact"}),e.jsx(c,{children:"Track"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Date"}),e.jsx(c,{className:"w-20",children:"Actions"})]})}),e.jsx(L,{children:h.map(s=>e.jsxs(y,{children:[e.jsx(o,{children:e.jsx(_,{checked:m.includes(s.id),onCheckedChange:r=>q(s.id,r)})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.organization_name||"Unknown Organization"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.industry||"No industry specified"})]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(je,{className:"h-3 w-3 mr-1 text-muted-foreground"}),s.full_name||"Anonymous"]}),s.email&&e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),s.email]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.role||"No role specified"})]})}),e.jsx(o,{children:S(s.track)}),e.jsx(o,{children:C(s.completed)}),e.jsxs(o,{children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(pe,{className:"h-3 w-3 mr-1 text-muted-foreground"}),g(new Date(s.created_at),"MMM dd, yyyy")]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:g(new Date(s.created_at),"HH:mm")})]}),e.jsx(o,{children:e.jsxs(we,{children:[e.jsx(ye,{asChild:!0,children:e.jsx(v,{size:"sm",variant:"outline",onClick:()=>X(s),children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsxs(O,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(F,{children:[e.jsx(V,{children:"Submission Details"}),e.jsx(U,{children:"Detailed view of assessment submission"})]}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Organization"}),e.jsx("p",{className:"text-sm",children:i.organization_name})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Contact"}),e.jsx("p",{className:"text-sm",children:i.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.email})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Role"}),e.jsx("p",{className:"text-sm",children:i.role})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Industry"}),e.jsx("p",{className:"text-sm",children:i.industry})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Company Size"}),e.jsx("p",{className:"text-sm",children:i.company_size})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Track"}),S(i.track)]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Assessment Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsx("span",{children:"Status:"})," ",C(i.completed),e.jsx("span",{children:"Regulated:"})," ",e.jsx(w,{variant:"outline",children:i.regulated?"Yes":"No"}),e.jsx("span",{children:"Created:"})," ",e.jsx("span",{children:g(new Date(i.created_at),"PPpp")}),e.jsx("span",{children:"Updated:"})," ",e.jsx("span",{children:g(new Date(i.updated_at),"PPpp")})]})]})]})]})]})})]},s.id))})]}),h.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No submissions found matching your criteria."})})]})})]})]})}export{ze as SubmissionsTable};
