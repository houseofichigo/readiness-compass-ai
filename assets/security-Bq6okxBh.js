import{s as a}from"./admin-CIYP8gkN.js";import"./ui-TC4ngNOa.js";import"./vendor-DXsvu-ZH.js";import"./assessment-BoZN5DJv.js";class l{static async logSecurityEvent(e){try{await a.from("security_events").insert({event_type:e.eventType,user_id:e.userId,ip_address:e.ipAddress,user_agent:e.userAgent||navigator.userAgent,event_data:e.eventData})}catch{}}static sanitizeInput(e){return e.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").trim()}static isValidEmail(e){return/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(e)&&e.length<=100&&!e.includes("<")&&!e.includes(">")}static async checkFeedbackRateLimit(){try{const e=await fetch("https://api.ipify.org?format=json"),{ip:t}=await e.json(),{data:r,error:i}=await a.rpc("check_feedback_rate_limit",{_ip_address:t});return i?!0:r}catch{return!0}}static getSecureHeaders(){return{"X-Frame-Options":"DENY","X-Content-Type-Options":"nosniff","X-XSS-Protection":"1; mode=block","Referrer-Policy":"strict-origin-when-cross-origin","Content-Security-Policy":"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"}}static generateCSRFToken(){return crypto.randomUUID()}static validateTextInput(e,t=1e3){if(!e||e.trim().length===0)return{isValid:!1,error:"Text cannot be empty"};if(e.length>t)return{isValid:!1,error:`Text cannot exceed ${t} characters`};const r=[/<script/i,/javascript:/i,/on\w+=/i,/<iframe/i,/<object/i,/<embed/i];for(const i of r)if(i.test(e))return{isValid:!1,error:"Invalid content detected"};return{isValid:!0}}static async logAuthAttempt(e,t,r){await this.logSecurityEvent({eventType:`auth_${r}_${t?"success":"failure"}`,eventData:{email:e.toLowerCase(),timestamp:new Date().toISOString(),success:t}})}}export{l as SecurityUtils};
